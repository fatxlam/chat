{"ast":null,"code":"import _objectSpread from \"/Volumes/1/chat/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _objectWithoutProperties from \"/Volumes/1/chat/frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _classCallCheck from \"/Volumes/1/chat/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Volumes/1/chat/frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Volumes/1/chat/frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Volumes/1/chat/frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Volumes/1/chat/frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Volumes/1/chat/frontend/src/App.js\";\nimport React, { Component } from 'react';\nimport { animateScroll } from 'react-scroll';\nimport InputForm from './companents/InputForm.js';\nimport MessagesList from './companents/MesagesList.js';\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, App);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(App)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      posts: [],\n      myName: undefined\n    };\n\n    _this.addMessage = function (_ref) {\n      var id = _ref.id,\n          rest = _objectWithoutProperties(_ref, [\"id\"]);\n\n      _this.state.posts.push(_objectSpread({\n        key: id\n      }, rest));\n\n      _this.setState({\n        posts: _this.state.posts\n      });\n    };\n\n    _this.handleSubmit = function (message) {\n      _this.socket.send(JSON.stringify({\n        authorName: _this.state.myName,\n        content: message\n      }));\n    };\n\n    _this.socket = undefined;\n\n    _this.handleSetName = function (name) {\n      _this.setState({\n        myName: name\n      });\n\n      _this.socket = new WebSocket(_this.props.uri);\n\n      _this.socket.onmessage = function (event) {\n        // console.log(event.data.type)\n        var message = JSON.parse(event.data);\n\n        if (message.type === 'message') {\n          console.log('message', message.type);\n\n          _this.addMessage(message.message);\n\n          if (!document.hasFocus()) _this.props.ring.play();\n        } else if (message.type === 'messages') {\n          _this.setState({\n            posts: message.messages\n          });\n        }\n\n        console.log('Получены данные ' + event.data);\n      };\n    };\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(nextProps, nextState) {\n      animateScroll.scrollToBottom();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"container\",\n        style: {\n          maxWidth: '400px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 59\n        },\n        __self: this\n      }, \"Websocket React Chat Example\"), React.createElement(\"p\", {\n        className: \"lead\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60\n        },\n        __self: this\n      }, \"\\u0427\\u0430\\u0442 \\u0441\\u043E\\u0437\\u0434\\u0430\\u043D\\u043D\\u044B\\u0439 \\u0432 \\u0443\\u0447\\u0435\\u0431\\u043D\\u044B\\u0445 \\u0446\\u0435\\u043B\\u044F\\u0445 \\u0441 \\u0438\\u0441\\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435\\u043C \\u0442\\u0435\\u0445\\u043D\\u043E\\u043B\\u043E\\u0433\\u0438\\u0439 React, Node.js, Bootstrap, Websocket\"), !this.state.myName ? React.createElement(InputForm, {\n        addMessage: this.handleSetName,\n        placeHolder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u0432\\u043E\\u0435 \\u0438\\u043C\\u044F\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65\n        },\n        __self: this\n      }) : React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"sticky-top\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        className: \"text-info\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72\n        },\n        __self: this\n      }, this.state.myName)), React.createElement(MessagesList, {\n        posts: this.state.posts,\n        myName: this.state.myName,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }), React.createElement(InputForm, {\n        addMessage: this.handleSubmit,\n        placeHolder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/Volumes/1/chat/frontend/src/App.js"],"names":["React","Component","animateScroll","InputForm","MessagesList","App","state","posts","myName","undefined","addMessage","id","rest","push","key","setState","handleSubmit","message","socket","send","JSON","stringify","authorName","content","handleSetName","name","WebSocket","props","uri","onmessage","event","parse","data","type","console","log","document","hasFocus","ring","play","messages","nextProps","nextState","scrollToBottom","maxWidth"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { animateScroll } from 'react-scroll'\n\nimport InputForm from './companents/InputForm.js'\nimport MessagesList from './companents/MesagesList.js'\n\nclass App extends Component {\n  state = { posts: [], myName: undefined }\n\n  addMessage = ({ id, ...rest }) => {\n    this.state.posts.push({\n      key: id,\n      ...rest\n    })\n    this.setState({\n      posts: this.state.posts\n    })\n  }\n\n  handleSubmit = message => {\n    this.socket.send(\n      JSON.stringify({\n        authorName: this.state.myName,\n        content: message\n      })\n    )\n  }\n\n  socket = undefined\n\n  handleSetName = name => {\n    this.setState({\n      myName: name\n    })\n    this.socket = new WebSocket(this.props.uri)\n    this.socket.onmessage = event => {\n      // console.log(event.data.type)\n      const message = JSON.parse(event.data)\n      if (message.type === 'message') {\n        console.log('message', message.type)\n        this.addMessage(message.message)\n        if (!document.hasFocus()) this.props.ring.play()\n      } else if (message.type === 'messages') {\n        this.setState({\n          posts: message.messages\n        })\n      }\n      console.log('Получены данные ' + event.data)\n    }\n  }\n\n  componentDidUpdate(nextProps, nextState) {\n    animateScroll.scrollToBottom()\n  }\n\n  render() {\n    return (\n      <div className=\"container\" style={{ maxWidth: '400px' }}>\n        <h2 className=\"text-center\">Websocket React Chat Example</h2>\n        <p className=\"lead\">\n          Чат созданный в учебных целях с использованием технологий React,\n          Node.js, Bootstrap, Websocket\n        </p>\n        {!this.state.myName ? (\n          <InputForm\n            addMessage={this.handleSetName}\n            placeHolder=\"Введите свое имя\"\n          />\n        ) : (\n          <div>\n            <div className=\"sticky-top\">\n              <h3 className=\"text-info\">{this.state.myName}</h3>\n            </div>\n            <MessagesList posts={this.state.posts} myName={this.state.myName} />\n            <InputForm\n              addMessage={this.handleSubmit}\n              placeHolder=\"Введите сообщение\"\n            />\n          </div>\n        )}\n      </div>\n    )\n  }\n}\n\nexport default App\n"]},"metadata":{},"sourceType":"module"}